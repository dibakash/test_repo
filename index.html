<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>SEC Shares Outstanding - Loading...</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

            body {
                font-family: 'Inter', sans-serif;
                background:black;
                color:white;
            }
        </style>

        <!-- <script src="script.js" defer></script> -->
        <!-- <script src="script2.js" defer></script> -->
    </head>

    <body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
        <div class="bg-white shadow-lg rounded-lg p-6 md:p-8 max-w-2xl w-full">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800 mb-6 text-center" id="page-title"><span
                    id="share-entity-name">Loading Company...</span> Common Stock Shares Outstanding</h1>
            <div id="loading-spinner" class="text-center py-8">
                <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-gray-900 mx-auto mb-4"></div>
                <p class="text-gray-600">Fetching data from SEC...</p>
            </div>
            <div id="data-display" class="hidden">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-blue-50 border border-blue-200 rounded-lg p-5">
                        <h2 class="text-xl font-semibold text-blue-700 mb-3">Maximum Shares Outstanding</h2>
                        <p class="text-gray-700 text-2xl font-bold mb-1"><span id="share-max-value"
                                class="text-blue-900">N/A</span></p>
                        <p class="text-gray-500 text-sm">Fiscal Year: <span id="share-max-fy">N/A</span></p>
                    </div>
                    <div class="bg-green-50 border border-green-200 rounded-lg p-5">
                        <h2 class="text-xl font-semibold text-green-700 mb-3">Minimum Shares Outstanding</h2>
                        <p class="text-gray-700 text-2xl font-bold mb-1"><span id="share-min-value"
                                class="text-green-900">N/A</span></p>
                        <p class="text-gray-500 text-sm">Fiscal Year: <span id="share-min-fy">N/A</span></p>
                    </div>
                </div>
                <p class="text-sm text-gray-500 mt-6 text-center">Data filtered for fiscal years greater than 2020.</p>
            </div>
            <div id="error-message" class="hidden text-center py-8 text-red-600">
                <p class="text-lg font-semibold mb-2">Error loading data.</p>
                <p id="error-details" class="text-sm">Please try again later or check the CIK.</p>
            </div>
        </div>
        <script>
            document.addEventListener('DOMContentLoaded', () => {
                const defaultCik = '0000315293';
                const urlParams = new URLSearchParams(window.location.search);
                const cikParam = urlParams.get('CIK');
                const currentCik = cikParam || defaultCik;
                const loadingSpinner = document.getElementById('loading-spinner');
                const dataDisplay = document.getElementById('data-display');
                const errorMessage = document.getElementById('error-message');
                const errorDetails = document.getElementById('error-details');
                async function fetchSECData(cik) {
                    loadingSpinner.classList.remove('hidden');
                    dataDisplay.classList.add('hidden');
                    errorMessage.classList.add('hidden');
                    let apiUrl = `https://data.sec.gov/api/xbrl/companyconcept/CIK${cik}/dei/EntityCommonStockSharesOutstanding.json`;
                    let fetchUrl = apiUrl; if (cik !== defaultCik) {
                        fetchUrl = `https://api.allorigins.win/raw?url=${encodeURIComponent(apiUrl)}`;
                    }

                    try {
                        const response = await fetch(fetchUrl, { headers: { 'User-Agent': 'AonInvestorApp Contact@Aon.com' } });
                        if (!response.ok) {
                            throw new Error(`HTTP error! Status: ${response.status} - ${response.statusText}`);
                        }
                        const data = await response.json(); processAndDisplayData(data);
                    }
                    catch (error) {
                        console.error('Failed to fetch or process SEC data:', error);
                        errorDetails.textContent = `Error: ${error.message}. Please check the CIK or try again later.`;
                        errorMessage.classList.remove('hidden'); loadingSpinner.classList.add('hidden');
                    }
                }

                function processAndDisplayData(data) {
                    loadingSpinner.classList.add('hidden');
                    if (!data || !data.entityName || !data.units || !data.units.shares) {
                        errorDetails.textContent = "No relevant shares outstanding data found for this CIK or the data structure is unexpected.";
                        errorMessage.classList.remove('hidden');
                        return;
                    }

                    const entityName = data.entityName;
                    document.title = `SEC Shares Outstanding - ${entityName}`;
                    document.getElementById('share-entity-name').textContent = entityName;
                    document.getElementById('page-title').innerHTML = `${entityName} Common Stock Shares Outstanding`;
                    const filteredShares = data.units.shares
                        .filter(item => item.fy > "2020" && typeof item.val === 'number')
                        .map(item => ({ val: item.val, fy: item.fy }));
                    if (filteredShares.length === 0) {
                        errorDetails.textContent = `No shares outstanding data found for fiscal years greater than 2020 for ${entityName}.`;
                        errorMessage.classList.remove('hidden');
                        return;
                    }

                    let maxShare = filteredShares[0];
                    let minShare = filteredShares[0];
                    filteredShares.forEach(share => {
                        if (share.val > maxShare.val) {
                            maxShare = share;
                        }
                        if (share.val < minShare.val) {
                            minShare = share;
                        }
                    });
                    document.getElementById('share-max-value').textContent = maxShare.val.toLocaleString();
                    document.getElementById('share-max-fy').textContent = maxShare.fy;
                    document.getElementById('share-min-value').textContent = minShare.val.toLocaleString();
                    document.getElementById('share-min-fy').textContent = minShare.fy;
                    dataDisplay.classList.remove('hidden');
                } fetchSECData(currentCik);
            });

        </script>
    </body>

</html>
